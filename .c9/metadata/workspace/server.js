{"changed":true,"filter":false,"title":"server.js","tooltip":"/server.js","value":"var http = require('http');\nvar path = require('path');\nvar express = require('express');\nvar bodyParser = require('body-parser');\nvar fs = require('fs');\nvar js2xmlparser = require(\"js2xmlparser\");\nvar xslt = require('node_xslt');\n\nvar router = express();\nvar server = http.createServer(router);\n\nrouter.use(express.static(path.resolve(__dirname, 'public')));\nrouter.use(bodyParser.urlencoded({extended: true}));\nrouter.use(bodyParser.json());\n\n// GET request to dislay index.html located inside /client folder\nrouter.get('/', function(req, res) {\n  res.render('index');\n});\n\n// GET request to send back JSON file\nrouter.get('/get/json', function(req, res) {\n  res.setHeader('Content-Type', 'application/json');\n  var obj = JSON.parse(fs.readFileSync('Orders.json', 'utf8'));\n  console.log(\"test\");\n  res.end(JSON.stringify(obj));\n});\n\n// HTML produced by XSL Transformation\nrouter.get('/Computers.html', function(req, res) {\n  \n  // Read in XML and XSL files\n  var stylesheet = xslt.readXsltFile('Computers.xsl');\n  var doc = xslt.readXmlFile('Computers.xml');\n  \n  // Apply transformation\n  var result = xslt.transform(stylesheet, doc, []);\n  \n  // Render the result\n  res.send(result);\n  \n});\n\n// HTML produced by XSL Transformation\nrouter.get('/Laptops.html', function(req, res) {\n  \n  // Read in XML and XSL files\n  var stylesheet = xslt.readXsltFile('Laptops.xsl');\n  var doc = xslt.readXmlFile('Laptops.xml');\n  \n  // Apply transformation\n  var result = xslt.transform(stylesheet, doc, []);\n  \n  // Render the result\n  res.send(result);\n  \n});\n\n// HTML produced by XSL Transformation\nrouter.get('/PCcomponents.html', function(req, res) {\n  \n  // Read in XML and XSL files\n  var stylesheet = xslt.readXsltFile('PCcomponents.xsl');\n  var doc = xslt.readXmlFile('PCcomponents.xml');\n  \n  // Apply transformation\n  var result = xslt.transform(stylesheet, doc, []);\n  \n  // Render the result\n  res.send(result);\n  \n});\n\n// HTML produced by XSL Transformation\nrouter.get('/Peripherals.html', function(req, res) {\n  \n  // Read in XML and XSL files\n  var stylesheet = xslt.readXsltFile('Peripherals.xsl');\n  var doc = xslt.readXmlFile('Peripherals.xml');\n  \n  // Apply transformation\n  var result = xslt.transform(stylesheet, doc, []);\n  \n  // Render the result\n  res.send(result);\n  \n});\n\n// HTML produced by XSL Transformation\nrouter.get('/Orders.html', function(req, res) {\n  \n  // Read in XML and XSL files\n  var stylesheet = xslt.readXsltFile('Orders.xsl');\n  var doc = xslt.readXmlFile('Orders.xml');\n  \n  // Apply transformation\n  var result = xslt.transform(stylesheet, doc, []);\n  \n  // Render the result\n  res.send(result);\n  \n});\n\n// POST request to add to JSON & XML files\nrouter.post('/post/json', function(req, res) {\n\n  // Function to read in a JSON file, add to it & convert to XML\n  function appendJSON(obj) {\n\n    // Read in a JSON file\n    var JSONfile = fs.readFileSync('Orders.json', 'utf8');\n\n    // Parse the JSON file in order to be able to edit it \n    var JSONparsed = JSON.parse(JSONfile);\n\n    // Add a new record into the array within the JSON file    \n    JSONparsed.order.push(obj);\n\n    // Beautify the resulting JSON file\n    var JSONformated = JSON.stringify(JSONparsed, null, 4);\n\n    // Write the updated JSON file back to the system \n    fs.writeFileSync('Orders.json', JSONformated);\n\n    // Convert the updated JSON file to XML     \n    var XMLformated = js2xmlparser(\"orders\", JSONformated);\n\n    // Write the resulting XML back to the system\n    fs.writeFileSync('Orders.xml', XMLformated);\n\n  }\n\n  // Call appendJSON function and pass in body of the current POST request\n  appendJSON(req.body);\n  \n  // Re-direct the browser back to the page, where the POST request came from\n  res.redirect('back');\n\n});\n\nserver.listen(process.env.PORT || 3000, process.env.IP || \"0.0.0.0\", function() {\n  var addr = server.address();\n  console.log(\"Server listening at\", addr.address + \":\" + addr.port);\n});","undoManager":{"mark":52,"position":100,"stack":[[{"start":{"row":100,"column":18},"end":{"row":100,"column":19},"action":"insert","lines":["e"],"id":524}],[{"start":{"row":100,"column":19},"end":{"row":100,"column":20},"action":"insert","lines":["r"],"id":525}],[{"start":{"row":100,"column":19},"end":{"row":100,"column":20},"action":"remove","lines":["r"],"id":526}],[{"start":{"row":100,"column":18},"end":{"row":100,"column":19},"action":"remove","lines":["e"],"id":527}],[{"start":{"row":88,"column":22},"end":{"row":88,"column":23},"action":"remove","lines":["n"],"id":545}],[{"start":{"row":88,"column":21},"end":{"row":88,"column":22},"action":"remove","lines":["o"],"id":546}],[{"start":{"row":88,"column":20},"end":{"row":88,"column":21},"action":"remove","lines":["s"],"id":547}],[{"start":{"row":88,"column":19},"end":{"row":88,"column":20},"action":"remove","lines":["j"],"id":548}],[{"start":{"row":88,"column":19},"end":{"row":88,"column":20},"action":"insert","lines":["O"],"id":549}],[{"start":{"row":88,"column":20},"end":{"row":88,"column":21},"action":"insert","lines":["r"],"id":550}],[{"start":{"row":88,"column":21},"end":{"row":88,"column":22},"action":"insert","lines":["d"],"id":551}],[{"start":{"row":88,"column":22},"end":{"row":88,"column":23},"action":"insert","lines":["e"],"id":552}],[{"start":{"row":88,"column":23},"end":{"row":88,"column":24},"action":"insert","lines":["r"],"id":553}],[{"start":{"row":88,"column":24},"end":{"row":88,"column":25},"action":"insert","lines":["s"],"id":554}],[{"start":{"row":88,"column":25},"end":{"row":88,"column":26},"action":"insert","lines":["."],"id":555}],[{"start":{"row":88,"column":26},"end":{"row":88,"column":27},"action":"insert","lines":["j"],"id":556}],[{"start":{"row":88,"column":27},"end":{"row":88,"column":28},"action":"insert","lines":["s"],"id":557}],[{"start":{"row":88,"column":28},"end":{"row":88,"column":29},"action":"insert","lines":["o"],"id":558}],[{"start":{"row":88,"column":29},"end":{"row":88,"column":30},"action":"insert","lines":["n"],"id":559}],[{"start":{"row":88,"column":25},"end":{"row":88,"column":26},"action":"remove","lines":["."],"id":560}],[{"start":{"row":88,"column":24},"end":{"row":88,"column":25},"action":"remove","lines":["s"],"id":561}],[{"start":{"row":88,"column":23},"end":{"row":88,"column":24},"action":"remove","lines":["r"],"id":562}],[{"start":{"row":88,"column":22},"end":{"row":88,"column":23},"action":"remove","lines":["e"],"id":563}],[{"start":{"row":88,"column":21},"end":{"row":88,"column":22},"action":"remove","lines":["d"],"id":564}],[{"start":{"row":88,"column":20},"end":{"row":88,"column":21},"action":"remove","lines":["r"],"id":565}],[{"start":{"row":88,"column":19},"end":{"row":88,"column":20},"action":"remove","lines":["O"],"id":566}],[{"start":{"row":23,"column":40},"end":{"row":23,"column":49},"action":"remove","lines":["Computers"],"id":567},{"start":{"row":23,"column":40},"end":{"row":23,"column":41},"action":"insert","lines":["o"]}],[{"start":{"row":23,"column":41},"end":{"row":23,"column":42},"action":"insert","lines":["r"],"id":568}],[{"start":{"row":23,"column":42},"end":{"row":23,"column":43},"action":"insert","lines":["d"],"id":569}],[{"start":{"row":23,"column":43},"end":{"row":23,"column":44},"action":"insert","lines":["e"],"id":570}],[{"start":{"row":23,"column":44},"end":{"row":23,"column":45},"action":"insert","lines":["r"],"id":571}],[{"start":{"row":23,"column":45},"end":{"row":23,"column":46},"action":"insert","lines":["s"],"id":572}],[{"start":{"row":23,"column":40},"end":{"row":23,"column":41},"action":"remove","lines":["o"],"id":573}],[{"start":{"row":23,"column":40},"end":{"row":23,"column":41},"action":"insert","lines":["O"],"id":574}],[{"start":{"row":23,"column":63},"end":{"row":24,"column":0},"action":"insert","lines":["",""],"id":575},{"start":{"row":24,"column":0},"end":{"row":24,"column":2},"action":"insert","lines":["  "]}],[{"start":{"row":24,"column":2},"end":{"row":24,"column":3},"action":"insert","lines":["c"],"id":576}],[{"start":{"row":24,"column":3},"end":{"row":24,"column":4},"action":"insert","lines":["o"],"id":577}],[{"start":{"row":24,"column":4},"end":{"row":24,"column":5},"action":"insert","lines":["n"],"id":578}],[{"start":{"row":24,"column":5},"end":{"row":24,"column":6},"action":"insert","lines":["s"],"id":579}],[{"start":{"row":24,"column":6},"end":{"row":24,"column":7},"action":"insert","lines":["o"],"id":580}],[{"start":{"row":24,"column":7},"end":{"row":24,"column":8},"action":"insert","lines":["l"],"id":581}],[{"start":{"row":24,"column":8},"end":{"row":24,"column":9},"action":"insert","lines":["e"],"id":582}],[{"start":{"row":24,"column":9},"end":{"row":24,"column":10},"action":"insert","lines":["."],"id":583}],[{"start":{"row":24,"column":10},"end":{"row":24,"column":11},"action":"insert","lines":["l"],"id":584}],[{"start":{"row":24,"column":11},"end":{"row":24,"column":12},"action":"insert","lines":["o"],"id":585}],[{"start":{"row":24,"column":12},"end":{"row":24,"column":13},"action":"insert","lines":["g"],"id":586}],[{"start":{"row":24,"column":13},"end":{"row":24,"column":15},"action":"insert","lines":["()"],"id":587}],[{"start":{"row":24,"column":14},"end":{"row":24,"column":16},"action":"insert","lines":["\"\""],"id":588}],[{"start":{"row":24,"column":15},"end":{"row":24,"column":16},"action":"insert","lines":["t"],"id":589}],[{"start":{"row":24,"column":16},"end":{"row":24,"column":17},"action":"insert","lines":["e"],"id":590}],[{"start":{"row":24,"column":17},"end":{"row":24,"column":18},"action":"insert","lines":["s"],"id":591}],[{"start":{"row":24,"column":18},"end":{"row":24,"column":19},"action":"insert","lines":["t"],"id":592}],[{"start":{"row":24,"column":21},"end":{"row":24,"column":22},"action":"insert","lines":[";"],"id":593}],[{"start":{"row":86,"column":3},"end":{"row":87,"column":0},"action":"insert","lines":["",""],"id":612}],[{"start":{"row":87,"column":0},"end":{"row":88,"column":0},"action":"insert","lines":["",""],"id":613}],[{"start":{"row":88,"column":0},"end":{"row":101,"column":3},"action":"insert","lines":["// HTML produced by XSL Transformation","router.get('/Peripherals.html', function(req, res) {","  ","  // Read in XML and XSL files","  var stylesheet = xslt.readXsltFile('Peripherals.xsl');","  var doc = xslt.readXmlFile('Peripherals.xml');","  ","  // Apply transformation","  var result = xslt.transform(stylesheet, doc, []);","  ","  // Render the result","  res.send(result);","  ","});"],"id":614}],[{"start":{"row":89,"column":22},"end":{"row":89,"column":23},"action":"remove","lines":["l"],"id":615}],[{"start":{"row":89,"column":21},"end":{"row":89,"column":22},"action":"remove","lines":["a"],"id":616}],[{"start":{"row":89,"column":20},"end":{"row":89,"column":21},"action":"remove","lines":["r"],"id":617}],[{"start":{"row":89,"column":19},"end":{"row":89,"column":20},"action":"remove","lines":["e"],"id":618}],[{"start":{"row":89,"column":18},"end":{"row":89,"column":19},"action":"remove","lines":["h"],"id":619}],[{"start":{"row":89,"column":17},"end":{"row":89,"column":18},"action":"remove","lines":["p"],"id":620}],[{"start":{"row":89,"column":16},"end":{"row":89,"column":17},"action":"remove","lines":["i"],"id":621}],[{"start":{"row":89,"column":15},"end":{"row":89,"column":16},"action":"remove","lines":["r"],"id":622}],[{"start":{"row":89,"column":14},"end":{"row":89,"column":15},"action":"remove","lines":["e"],"id":623}],[{"start":{"row":89,"column":13},"end":{"row":89,"column":14},"action":"remove","lines":["P"],"id":624}],[{"start":{"row":89,"column":13},"end":{"row":89,"column":14},"action":"insert","lines":["O"],"id":625}],[{"start":{"row":89,"column":14},"end":{"row":89,"column":15},"action":"insert","lines":["r"],"id":626}],[{"start":{"row":89,"column":15},"end":{"row":89,"column":16},"action":"insert","lines":["d"],"id":627}],[{"start":{"row":89,"column":16},"end":{"row":89,"column":17},"action":"insert","lines":["e"],"id":628}],[{"start":{"row":89,"column":17},"end":{"row":89,"column":18},"action":"insert","lines":["r"],"id":629}],[{"start":{"row":92,"column":47},"end":{"row":92,"column":48},"action":"remove","lines":["l"],"id":630}],[{"start":{"row":92,"column":46},"end":{"row":92,"column":47},"action":"remove","lines":["a"],"id":631}],[{"start":{"row":92,"column":45},"end":{"row":92,"column":46},"action":"remove","lines":["r"],"id":632}],[{"start":{"row":92,"column":44},"end":{"row":92,"column":45},"action":"remove","lines":["e"],"id":633}],[{"start":{"row":92,"column":43},"end":{"row":92,"column":44},"action":"remove","lines":["h"],"id":634}],[{"start":{"row":92,"column":42},"end":{"row":92,"column":43},"action":"remove","lines":["p"],"id":635}],[{"start":{"row":92,"column":41},"end":{"row":92,"column":42},"action":"remove","lines":["i"],"id":636}],[{"start":{"row":92,"column":40},"end":{"row":92,"column":41},"action":"remove","lines":["r"],"id":637}],[{"start":{"row":92,"column":39},"end":{"row":92,"column":40},"action":"remove","lines":["e"],"id":638}],[{"start":{"row":92,"column":38},"end":{"row":92,"column":39},"action":"remove","lines":["P"],"id":639}],[{"start":{"row":92,"column":38},"end":{"row":92,"column":39},"action":"insert","lines":["O"],"id":640}],[{"start":{"row":92,"column":39},"end":{"row":92,"column":40},"action":"insert","lines":["r"],"id":641}],[{"start":{"row":92,"column":40},"end":{"row":92,"column":41},"action":"insert","lines":["d"],"id":642}],[{"start":{"row":92,"column":41},"end":{"row":92,"column":42},"action":"insert","lines":["e"],"id":643}],[{"start":{"row":92,"column":42},"end":{"row":92,"column":43},"action":"insert","lines":["r"],"id":644}],[{"start":{"row":93,"column":39},"end":{"row":93,"column":40},"action":"remove","lines":["l"],"id":645}],[{"start":{"row":93,"column":38},"end":{"row":93,"column":39},"action":"remove","lines":["a"],"id":646}],[{"start":{"row":93,"column":37},"end":{"row":93,"column":38},"action":"remove","lines":["r"],"id":647}],[{"start":{"row":93,"column":36},"end":{"row":93,"column":37},"action":"remove","lines":["e"],"id":648}],[{"start":{"row":93,"column":35},"end":{"row":93,"column":36},"action":"remove","lines":["h"],"id":649}],[{"start":{"row":93,"column":34},"end":{"row":93,"column":35},"action":"remove","lines":["p"],"id":650}],[{"start":{"row":93,"column":33},"end":{"row":93,"column":34},"action":"remove","lines":["i"],"id":651}],[{"start":{"row":93,"column":32},"end":{"row":93,"column":33},"action":"remove","lines":["r"],"id":652}],[{"start":{"row":93,"column":31},"end":{"row":93,"column":32},"action":"remove","lines":["e"],"id":653}],[{"start":{"row":93,"column":30},"end":{"row":93,"column":31},"action":"remove","lines":["P"],"id":654}],[{"start":{"row":93,"column":30},"end":{"row":93,"column":31},"action":"insert","lines":["O"],"id":655}],[{"start":{"row":93,"column":31},"end":{"row":93,"column":32},"action":"insert","lines":["r"],"id":656}],[{"start":{"row":93,"column":32},"end":{"row":93,"column":33},"action":"insert","lines":["d"],"id":657}],[{"start":{"row":93,"column":33},"end":{"row":93,"column":34},"action":"insert","lines":["e"],"id":658}],[{"start":{"row":93,"column":34},"end":{"row":93,"column":35},"action":"insert","lines":["r"],"id":659}]]},"ace":{"folds":[],"scrolltop":1140,"scrollleft":0,"selection":{"start":{"row":94,"column":2},"end":{"row":94,"column":2},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":75,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1450448737000}